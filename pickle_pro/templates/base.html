 {% load static %}

 <!DOCTYPE html>
 <html lang="en">
 <head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>FarmDidi</title>
     <link rel="stylesheet" type="text/css" href="{% static 'assets/css/bootstrap.min.css'%}">
     <link rel="stylesheet" type="text/css" href="{% static 'assets/CSS/styles.css'%}">
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
     <link rel="stylesheet" type="text/css" href="{% static 'assets/css/owl.carousel.min.css'%}">
     <link rel="stylesheet" type="text/css" href="{% static 'assets/css/owl.theme.default.min.css'%}">
     <link rel="stylesheet" type="text/css" href="{% static 'assets/css/owl.theme.green.min.css'%}">
     <link rel="stylesheet" type="text/css" href="{% static 'assets/css/hover-min.css'%}">
     <link rel="stylesheet" type="text/css" href="{% static 'assets/css/ihover.css'%}">
     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
 </head>
 <body>
     <!------------ navbar start ------------>
     <div class="container-fuild fixed-top">
      <marquee behavior="scroll" direction="left">Jars â‚¹999</strong> | Buy any <strong>4 Code: <strong>BUY@999</strong> | Extra <strong>5% OFF</strong> on <strong>Prepaid</strong> orders</marquee>
    </div>
  
    <nav class="navbar navbar-expand-lg mymenu co sticky-top bg-body-tertiary">
        <div class="container">
          <a class="navbar-brand" href="#">
            <img src="{% static 'assets/images/maa_logo.png'%}" alt="">
          </a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
        <div class="collapse navbar-collapse  mynav" id="navbarNavDropdown">
             <ul class="navbar-nav">
                 <li class="nav-item"><a class="nav-link" href="{% url 'home' %}">Home</a></li>
                 <li class="nav-item dropdown">
                   <a class="nav-link dropdown-toggle" href="#" id="ingredientsDropdown" role="button"
                      data-bs-toggle="dropdown" aria-expanded="false">
                       Shop by Ingredients
                   </a>
                   <ul class="dropdown-menu subul" aria-labelledby="ingredientsDropdown">
                       <li><a class="dropdown-item" href="{% url 'mango' %}">Mango</a></li>
                       <li><a class="dropdown-item" href="{% url 'Lemon' %}">Lemon</a></li>
                       <li><a class="dropdown-item" href="{% url 'Mixed' %}">Mixed</a></li>
                       <li><a class="dropdown-item" href="{% url 'Panjabi' %}">Panjabi</a></li>
                       <li><a class="dropdown-item" href="{% url 'kerda' %}">kerda </a></li>
                       <li><a class="dropdown-item" href="{% url 'Carrot' %}">Carrot</a></li>
                   </ul>
                 </li>
                 <li class="nav-item dropdown">
                   <a class="nav-link dropdown-toggle" href="#" id="tasteDropdown" role="button"
                      data-bs-toggle="dropdown" aria-expanded="false">
                       Shop by Taste
                   </a>
                   <ul class="dropdown-menu subul" aria-labelledby="tasteDropdown">
                     <li><a class="dropdown-item" href="{% url 'spicy' %}">Spicy</a></li>
                     <li><a class="dropdown-item" href="{% url 'sweet' %}">Sweet</a></li>
                   </ul>
                </li>
                 <li class="nav-item dropdown">
                 <a class="nav-link dropdown-toggle" href="#" id="storyDropdown" role="button"
                    data-bs-toggle="dropdown" aria-expanded="false">
                     Our Story
                 </a>
                 <ul class="dropdown-menu subul" aria-labelledby="storyDropdown">
                     <li><a class="dropdown-item" href="{% url 'howwe' %}">How We</a></li>
                     <li><a class="dropdown-item" href="{% url 'makeour' %}">Make Our</a></li>
                     <li><a class="dropdown-item" href="{% url 'products' %}">Products</a></li>
                 </ul>
                 </li>
                 <li class="nav-item"><a class="nav-link" href="{% url 'blogs' %}">blogs</a></li>
                 <li class="nav-item"><a class="nav-link" href="{% url 'Contact' %}">Contact</a></li>
               </ul>
               <div class="search-container">
                   <input type="text" class="form-control search-input" placeholder="Search our store">
                   <button class="search-btn">
                       <i class="bi bi-search"></i>
                   </button>
               </div>
               
             <button class="icon-button ab" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight">
               <i class="bi bi-person-fill"></i>
             </button>
             
             <div class="item rounded">
               <div class="col my-3 position-relative">
                <button class="btn icon-button ma ab" data-bs-toggle="offcanvas" data-bs-target="#cartCanvas">
                  <i class="fas fa-shopping-cart"></i> 
              </button>
              <div class="position-absolute text-dec">
                  <span id="cartCount" class="cart-count d-none badge text-bg-danger text-dec rounded">0</span>
              </div>
               </div>
             </div>
 
         </div>
       </div>
     </nav>
 
     <!---------------- login Sidebar start ---------------->
     <div class="offcanvas offcanvas-end login" tabindex="-1" id="offcanvasRight">
      <div class="offcanvas-header log">
          <h5 class="offcanvas-title">LOGIN</h5>
          <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
      </div>
      <div class="offcanvas-body">
        <form>
            <div class="mb-3">
                <label for="email" class="form-label">Email</label>
                <input type="email" class="form-control" id="email" placeholder="Enter your email">
            </div>
            <div class="mb-3">
                <label for="password" class="form-label">Password</label>
                <input type="password" class="form-control" id="password" placeholder="Enter your password">
            </div>
            <div class="d-grid">
                <button type="submit" class="btn" style="background-color: #de941e;">Sign In</button>
            </div>
            <div class="text-center mt-3">
                <a href="{% url 'createaccount' %}" class="d-block">Create account</a>
                <a href="{% url 'password' %}" class="d-block">Forgot your password?</a>
            </div>
        </form>
    </div>
  </div>
    <!---------------- login Sidebar start ---------------->
 
       <!---------------- addtocart Sidebar start ---------------->
     <div class="offcanvas offcanvas-end off cart-offcanvas" tabindex="-1" id="cartCanvas">
       <div class="offcanvas-header add">
           <p>Buy any 4 jars <strong>999</strong> | Code :BUY@999</p>
           <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
       </div>
       <div class="offcanvas-body">
           <ul id="cartItems" class="list-group mb-3"></ul>
           <h5>Total: Rs <span id="totalPrice">0</span></h5>
       </div>
   </div>
   <!---------------- addtocart Sidebar start ---------------->
     
   <!------------ navbar End ---------------->
   
 <!------------ TopButton Start ---------------->
 <button id="topBtn" class="btn"><i class="bi bi-arrow-up-circle"></i></button>
 <!------------ TopButton End ---------------->

{% block main-content %}
{% endblock main-content %}

<!------------ Footer Start ------------>
<footer class="bg-light p-4">
  <div class="container text-center text-md-start">
    <div class="row">
       <div class="col-lg-7 col-md-12">
        <table class="table table-borderless text-center text-md-start">
          <thead>
            <tr>
              <th>SHOP</th>
              <th>POLICIES</th>
              <th>HELP</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Homemade Pickle</td>
              <td>Terms and Conditions</td>
              <td>Payments</td>
            </tr>
            <tr>
              <td>Sweet Pickle</td>
              <td>Privacy Policy</td>
              <td>Shipping Fees & Delivery</td>
            </tr>
            <tr>
              <td>Mango Pickle</td>
              <td>Cancellation Policy</td>
              <td>Track Order</td>
            </tr>
            <tr>
              <td>Chutneys</td>
              <td>Refund Policy</td>
              <td></td>
            </tr>
            <tr>
              <td>Homemade Sweets</td>
              <td>Exchange Policy</td>
              <td></td>
            </tr>
            <tr>
              <td>Homemade Papad</td>
              <td></td>
              <td></td>
            </tr>
          </tbody>
        </table>
      </div>  

      <div class="col-lg-5 col-md-12 text-center mt-4 foot">
        <img src="images/logo.jpeg" class="hvr-pulse-grow rounded" width="120px">
        <p class="mt-3 mb-3"><b>FOLLOW US FOR FARMDIDI</b></p>
        <ul class="list-inline">
          <li class="list-inline-item"><a href="#" class="hvr-pulse-grow"><i class="rounded fa-brands fa-facebook"></i></a></li>
                  <li class="list-inline-item"><a href="#" class="hvr-pulse-grow"><i class="rounded fa-brands fa-square-whatsapp"></i></a></li>
                  <li class="list-inline-item"><a href="#" class="hvr-pulse-grow"><i class="rounded fa-brands fa-telegram"></i></a></li>
                  <li class="list-inline-item"><a href="#" class="hvr-pulse-grow"><i class="rounded fa-brands fa-square-twitter"></i></a></li>
        </ul>
      </div> 
      <div class="light p-2">
        <div class="container-fluid">
            <hr>
            <p class="float-end">Designed By Aayushi Dudhat</p>
            <p>&copy; 2024 - All Rights Reserved</p>
        </div>
      </div>
</footer> 
          <!------------ Footer End ------------>
    
</body>
<script src="{% static '/assets/js/jquery.min.js'%}" type="text/javascript"></script>
<script src="{% static '/assets/js/owl.carousel.min.js'%}" type="text/javascript"></script>
<script src="{% static '/assets/js/bootstrap.bundle.min.js'%}" type="text/javascript"></script>

<script type="text/javascript">
  $('.owl-carousel').owlCarousel({
    loop:true,
    margin:10,
    nav:false,
    responsive:{
        0:{
            items:1
        },
        600:{
            items:1
        },
        1000:{
            items:3
        }
    }
})

window.onscroll = function () {
  let topBtn = document.getElementById("topBtn");
  if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
      topBtn.style.display = "block";
  } else {
      topBtn.style.display = "none";
  }
};

document.getElementById("topBtn").addEventListener("click", function () {
  window.scrollTo({ top: 0, behavior: "smooth" });
});

let totalPrice = 0;

        document.addEventListener("DOMContentLoaded", function () {
            document.querySelectorAll(".size-option").forEach(item => {
                item.addEventListener("click", function (e) {
                    e.preventDefault();
                    let parent = this.closest(".dropdown");
                    let dropdownText = parent.querySelector(".selected-price");
                    dropdownText.innerHTML = `${this.dataset.size} - Rs ${this.dataset.price}`;
                    dropdownText.setAttribute("data-price", this.dataset.price);
                    dropdownText.setAttribute("data-size", this.dataset.size);
                });
            });

            document.querySelectorAll(".add-to-cart").forEach(button => {
                button.addEventListener("click", function () {
                    let productCard = this.closest('.card');
                    let productName = productCard.querySelector(".product-name").textContent.trim();
                    let productImage = productCard.querySelector(".product-image").src;
                    let selectedSizeElement = productCard.querySelector('.selected-price');
                    let selectedSize = selectedSizeElement.getAttribute("data-size");
                    let selectedPrice = parseInt(selectedSizeElement.getAttribute("data-price"));
                    let cartItems = document.getElementById("cart-items");
                    let existingItem = [...cartItems.children].find(item => 
                        item.dataset.name === productName && item.dataset.size === selectedSize
                    );

                    if (existingItem) {
                        let quantityElement = existingItem.querySelector(".item-quantity");
                        let quantity = parseInt(quantityElement.textContent);
                        quantityElement.textContent = quantity + 1;
                    } else {
                        let cartItem = document.createElement("li");
                        cartItem.className = "list-group-item d-flex align-items-center";
                        cartItem.dataset.name = productName;
                        cartItem.dataset.size = selectedSize;
                       
                        cartItem.innerHTML = `
                          <img src="${productImage}" width="50" height="50" class="me-2">
                          <div class="cart-item-details">
                              <div>${productName}</div>
                              <div>(${selectedSize}) - Rs ${selectedPrice}</div>
                          </div>
                          <span class="count">
                              <button class="quantity-btn" onclick="updateQuantity(this, -1, ${selectedPrice})">-</button>
                              <span class="badge bg-primary rounded-pill item-quantity">1</span>
                              <button class="quantity-btn" onclick="updateQuantity(this, 1, ${selectedPrice})">+</button>
                          </span>
                          <button class="delete-btn dbtn" onclick="removeFromCart(this, ${selectedPrice})"><i class="bi bi-trash"></i></button>
                      `;
                      cartItems.appendChild(cartItem);
                    }

                    totalPrice += selectedPrice;
                    document.getElementById("total-price").innerText = totalPrice;
                    let offcanvas = new bootstrap.Offcanvas(document.getElementById("offcanvasaddtocart"));
                    offcanvas.show();
                });
            });
        });

        function updateQuantity(button, change, price) {
            let cartItem = button.closest("li");
            let quantityElement = cartItem.querySelector(".item-quantity");
            let quantity = parseInt(quantityElement.textContent) + change;

            if (quantity > 0) {
                quantityElement.textContent = quantity;
                totalPrice += change * price;
            } else {
                cartItem.remove();
                totalPrice -= price;
            }

            document.getElementById("total-price").innerText = totalPrice;
        }

        function removeFromCart(button, price) {
            let cartItem = button.closest("li");
            let quantityElement = cartItem.querySelector(".item-quantity");
            let quantity = parseInt(quantityElement.textContent);
            totalPrice -= price * quantity;
            cartItem.remove();
            document.getElementById("total-price").innerText = totalPrice;
        }

      function placeOrder() {
        window.location.href = "order.html";
      }

      document.getElementById("signup-form").addEventListener("submit", function(event) {
        event.preventDefault();
        alert("Account created successfully!");
    });
      let cart = [];
       
        document.querySelectorAll(".size-option").forEach(option => {
            option.addEventListener("click", function() {
                let btn = this.closest(".dropdown").querySelector(".selected-price");
                btn.innerText = `${this.dataset.size} - Rs ${this.dataset.price}`;
                btn.dataset.price = this.dataset.price;
                btn.dataset.size = this.dataset.size;
            });
        });
        
        document.querySelectorAll(".add-to-cart").forEach(button => {
            button.addEventListener("click", function() {
                let card = this.closest(".card");
                let name = card.querySelector(".product-name").innerText;
                let sizeEl = card.querySelector(".selected-price");
                let price = parseInt(sizeEl.dataset.price);
                let size = sizeEl.dataset.size;
                let imageSrc = card.querySelector(".product-image").src;
                
                let item = cart.find(i => i.name === name && i.size === size);
                if (item) {
                    item.quantity++;
                } else {
                    cart.push({ name, price, size, quantity: 1, imageSrc });
                }
                updateCart();
                new bootstrap.Offcanvas(document.getElementById('cartCanvas')).show();
            });
        });

        function updateCart() {
          let cartList = document.getElementById("cartItems");
          let total = 0;
          let cartCount = document.getElementById("cartCount");
          cartList.innerHTML = "";
          cart.forEach((item, index) => {
              let itemTotal = item.price * item.quantity;
              total += itemTotal;
              cartList.innerHTML += `
                  <li class='list-group-item d-flex align-items-center justify-content-between'>
                      <img src='${item.imageSrc}' class='cart-item-img me-2'>
                      <div class='flex-grow-1'>
                          ${item.name} (${item.size})
                          <div class="quantity-selector mt-2">
                              <button onclick="changeQuantity(${index}, -1)">&#128465;</button>
                              <input type="number" value="${item.quantity}" min="1" readonly>
                              <button onclick="changeQuantity(${index}, 1)">&#43;</button>
                          </div>
                      </div>
                      <span>Rs ${itemTotal}</span>
                  </li>`;
          });

          document.getElementById("totalPrice").innerText = total;
          cartCount.innerText = cart.length;
          cartCount.classList.toggle("d-none", cart.length === 0);
      }

        function changeQuantity(index, change) {
            let item = cart[index];
            if (change === -1 && item.quantity === 1) {
                cart.splice(index, 1); 
            } else {
                item.quantity += change;
            }
            updateCart();
        }
   
</script>
</html>